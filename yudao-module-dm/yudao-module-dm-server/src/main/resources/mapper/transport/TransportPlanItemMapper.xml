<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.iocoder.yudao.module.dm.dal.mysql.transport.TransportPlanItemMapper">

    <select id="selectListByProductIdsAndDateRange" resultType="cn.iocoder.yudao.module.dm.dal.dataobject.transport.TransportPlanItemDO">
        SELECT
            i.*,
            p.despatch_date
        FROM
            dm_transport_plan_item i
            INNER JOIN dm_transport_plan p ON i.plan_id = p.id
        WHERE
            i.deleted = b'0'
            AND p.deleted = b'0'
            AND i.product_id IN
            <foreach collection="productIds" item="productId" open="(" separator="," close=")">
                #{productId}
            </foreach>
            AND p.transport_status >= 20
            AND p.despatch_date BETWEEN #{beginTime} AND #{endTime}
        ORDER BY
            i.product_id ASC, p.despatch_date ASC
    </select>

</mapper> 